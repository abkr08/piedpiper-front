{"ast":null,"code":"import * as actionTypes from '../actions';\nimport { ChatManager, TokenProvider } from '@pusher/chatkit-client';\nexport var chatInit = function chatInit() {\n  return function (dispatch, getState) {\n    var userId = getState().auth.userId;\n    var chatManager = new ChatManager({\n      instanceLocator: 'v1:us1:64b7dbdb-3e59-4fad-9823-83add90cba65',\n      userId: userId,\n      tokenProvider: new TokenProvider({\n        url: 'https://us1.pusherplatform.io/services/chatkit_token_provider/v1/64b7dbdb-3e59-4fad-9823-83add90cba65/token'\n      })\n    });\n    chatManager.connect({\n      onAddedToRoom: function onAddedToRoom(room) {// this.getRooms();\n        // this.setState({showSideDrawer: false, room: room});\n        // this.getMessages(room);\n      }\n    }).then(function (user) {\n      // this.currentUser = user;\n      // this.getRooms();\n      dispatch(chatInitSuccess(user));\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  };\n};\n\nvar chatInitSuccess = function chatInitSuccess(user) {\n  return {\n    type: actionTypes.CHAT_INIT_SUCCESS,\n    currentUser: user\n  };\n};\n\nexport var getRooms = function getRooms(user) {\n  return function (dispatch) {\n    var contacts = user.rooms;\n    contacts.map(function (con) {\n      return user.subscribeToRoom({\n        roomId: con.id,\n        hooks: {\n          onMessage: function onMessage(message) {//this.setState({messages: [...this.state.messages, message]});\n            //this.getMessages(message.room);\n            //this.scrollToBottom();\n          }\n        },\n        messageLimit: 100\n      });\n    });\n  };\n};","map":{"version":3,"sources":["/Users/gotzil/Desktop/Pied Piper Chat/client/src/store/actions/actionCreators/chatActionCreators.js"],"names":["actionTypes","ChatManager","TokenProvider","chatInit","dispatch","getState","userId","auth","chatManager","instanceLocator","tokenProvider","url","connect","onAddedToRoom","room","then","user","chatInitSuccess","catch","err","console","log","type","CHAT_INIT_SUCCESS","currentUser","getRooms","contacts","rooms","map","con","subscribeToRoom","roomId","id","hooks","onMessage","message","messageLimit"],"mappings":"AAAA,OAAO,KAAKA,WAAZ,MAA6B,YAA7B;AACA,SAASC,WAAT,EAAsBC,aAAtB,QAA2C,wBAA3C;AAEA,OAAO,IAAMC,QAAQ,GAAG,SAAXA,QAAW,GAAM;AAC1B,SAAO,UAACC,QAAD,EAAWC,QAAX,EAAwB;AAAA,QACpBC,MADoB,GACVD,QAAQ,GAAGE,IADD,CACpBD,MADoB;AAE3B,QAAME,WAAW,GAAG,IAAIP,WAAJ,CAAgB;AAChCQ,MAAAA,eAAe,EAAE,6CADe;AAEhCH,MAAAA,MAAM,EAAEA,MAFwB;AAGhCI,MAAAA,aAAa,EAAE,IAAIR,aAAJ,CAAkB;AAC7BS,QAAAA,GAAG,EAAE;AADwB,OAAlB;AAHiB,KAAhB,CAApB;AAOAH,IAAAA,WAAW,CACVI,OADD,CACS;AACLC,MAAAA,aAAa,EAAE,uBAAAC,IAAI,EAAI,CACnB;AACA;AACA;AACH;AALI,KADT,EAQCC,IARD,CAQM,UAAAC,IAAI,EAAI;AACV;AACA;AACAZ,MAAAA,QAAQ,CAACa,eAAe,CAACD,IAAD,CAAhB,CAAR;AACH,KAZD,EAaCE,KAbD,CAaO,UAAAC,GAAG;AAAA,aAAIC,OAAO,CAACC,GAAR,CAAYF,GAAZ,CAAJ;AAAA,KAbV;AAcH,GAvBD;AAwBH,CAzBM;;AA0BP,IAAMF,eAAe,GAAG,SAAlBA,eAAkB,CAAAD,IAAI,EAAI;AAC5B,SAAO;AACHM,IAAAA,IAAI,EAAEtB,WAAW,CAACuB,iBADf;AAEHC,IAAAA,WAAW,EAAER;AAFV,GAAP;AAIH,CALD;;AAMA,OAAO,IAAMS,QAAQ,GAAG,SAAXA,QAAW,CAAAT,IAAI,EAAI;AAC5B,SAAO,UAAAZ,QAAQ,EAAI;AACf,QAAMsB,QAAQ,GAAGV,IAAI,CAACW,KAAtB;AACAD,IAAAA,QAAQ,CAACE,GAAT,CAAa,UAAAC,GAAG,EAAI;AAChB,aAAQb,IAAI,CAACc,eAAL,CAAqB;AACxBC,QAAAA,MAAM,EAAEF,GAAG,CAACG,EADY;AAExBC,QAAAA,KAAK,EAAE;AACLC,UAAAA,SAAS,EAAE,mBAAAC,OAAO,EAAI,CACpB;AACA;AACA;AACD;AALI,SAFiB;AASxBC,QAAAA,YAAY,EAAE;AATU,OAArB,CAAR;AAWF,KAZF;AAaH,GAfD;AAgBH,CAjBM","sourcesContent":["import * as actionTypes from '../actions';\nimport { ChatManager, TokenProvider } from '@pusher/chatkit-client';\n\nexport const chatInit = () => { \n    return (dispatch, getState) => {\n        const {userId} = getState().auth;\n        const chatManager = new ChatManager({\n            instanceLocator: 'v1:us1:64b7dbdb-3e59-4fad-9823-83add90cba65',\n            userId: userId,\n            tokenProvider: new TokenProvider({\n                url: 'https://us1.pusherplatform.io/services/chatkit_token_provider/v1/64b7dbdb-3e59-4fad-9823-83add90cba65/token'\n            })\n        });    \n        chatManager\n        .connect({\n            onAddedToRoom: room => {\n                // this.getRooms();\n                // this.setState({showSideDrawer: false, room: room});\n                // this.getMessages(room);\n            }\n        })\n        .then(user => {\n            // this.currentUser = user;\n            // this.getRooms();\n            dispatch(chatInitSuccess(user));\n        })\n        .catch(err => console.log(err));\n    }\n}\nconst chatInitSuccess = user => {\n    return {\n        type: actionTypes.CHAT_INIT_SUCCESS,\n        currentUser: user\n    }\n}\nexport const getRooms = user => {\n    return dispatch => {\n        const contacts = user.rooms;\n        contacts.map(con => {\n            return  user.subscribeToRoom({\n                 roomId: con.id,\n                 hooks: {\n                   onMessage: message => {\n                     //this.setState({messages: [...this.state.messages, message]});\n                     //this.getMessages(message.room);\n                     //this.scrollToBottom();\n                   }\n                 },\n                 messageLimit: 100\n               })\n         })\n    }\n}"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import pusher from '../../../pusherConfig';\nimport * as actionTypes from '../actions';\nimport { store } from '../../../index';\nvar channel = pusher.subscribe('presence-videocall');\nvar caller = new window.RTCPeerConnection({\n  'iceServers': [{\n    'urls': 'stun:stun.l.google.com:19302'\n  }]\n});\nvar userId = localStorage.getItem('userId');\nvar room; //setInterval(()=> console.log(caller), 4000);\n\nchannel.bind(\"pusher:subscription_succeeded\", function (members) {//this.setState({id: this.props.channel.members.me.id, room: this.props.callTo});\n});\nchannel.bind(\"pusher:member_added\", function (member) {\n  console.log(member);\n});\nchannel.bind(\"pusher:member_removed\", function (member) {\n  if (member.id === room) {\n    //this.endCall();\n    alert('call Ended');\n  }\n});\nchannel.bind(\"client-candidate\", function (msg) {\n  console.log('client-candidate');\n\n  if (msg.room === room) {\n    addIceCandidate(new RTCIceCandidate(msg.candidate));\n  }\n});\nchannel.bind(\"client-sdp\", function (msg) {\n  console.log(msg.room, userId);\n\n  if (msg.room === userId) {\n    store.dispatch({\n      type: actionTypes.ON_INCOMING_CALL\n    });\n    var answer = window.confirm(\"You have a call from \" + msg.from + \": Would you like to answer?\");\n\n    if (!answer) {\n      return channel.trigger(\"client-reject\", {\n        room: msg.room,\n        rejected: userId\n      });\n    } else {\n      room = msg.room; //getCam('answer');\n\n      getMedia().then(function (stream) {\n        stream.getTracks().map(function (track) {\n          return addTrack(track, stream);\n        }); //let sessionDesc = new RTCSessionDescription(msg.sdp);\n        //setRemoteDescription(sessionDesc);\n\n        createAnswer();\n        store.dispatch(onLocalStream(stream));\n      });\n    }\n  }\n});\nchannel.bind(\"client-answer\", function (answer) {\n  console.log(answer.room, room);\n\n  if (answer.room === room) {\n    console.log(\"answer received\");\n    console.log(answer);\n    var sessionDesc = new RTCSessionDescription(answer.sdp);\n    setRemoteDescription(sessionDesc);\n  }\n});\n\nvar onLocalStream = function onLocalStream(stream) {\n  return {\n    type: actionTypes.ON_LOCAL_STREAM,\n    stream: stream\n  };\n}; //Create and send offer to remote peer on button click\n\n\nexport var callUser = function callUser(user) {\n  room = user;\n  return function (dispatch) {\n    //getCam('not-answer');\n    getMedia().then(function (stream) {\n      stream.getTracks().map(function (track) {\n        return addTrack(track, stream);\n      });\n      createOffer();\n      store.dispatch(onLocalStream(stream));\n    });\n  };\n};\n\nvar getCam = function getCam(param) {\n  //Get local audio/video feed and show it in selfview video element\n  // return dispatch => {\n  getMedia().then(function (stream) {\n    stream.getTracks().forEach(function (track) {\n      return addTrack(track, stream);\n    });\n\n    if (param !== 'answer') {\n      createOffer();\n    }\n\n    store.dispatch(onLocalStream(stream));\n  }).catch(function (error) {\n    console.log(\"an error occured\", error);\n  });\n  ; // }\n};\n\nvar getMedia = function getMedia() {\n  return navigator.mediaDevices.getUserMedia({\n    video: true,\n    audio: true\n  });\n};\n\nvar prepareCaller = function prepareCaller(channel) {\n  return {\n    type: actionTypes.PREPARE_CALLER,\n    channel: channel\n  };\n};\n\nvar onTrack = function onTrack(track) {\n  return {\n    type: actionTypes.ON_TRACK,\n    remoteStream: track.streams[0]\n  };\n};\n\nexport var getCallerReady = function getCallerReady() {\n  return function (dispatch) {\n    dispatch(prepareCaller(channel)); //Listen for ICE Candidates and send them to remote peers\n\n    caller.onicecandidate = function (evt) {\n      if (!evt.candidate) return;\n      onIceCandidate(caller, evt);\n    }; //ontrack handler to receive remote feed and show in remoteview video element\n\n\n    caller.ontrack = function (evt) {\n      dispatch(onTrack(evt));\n    };\n  };\n};\nexport var addIceCandidate = function addIceCandidate(iceCandidate) {\n  // return dispatch => {\n  console.log(iceCandidate);\n  caller.addIceCandidate(iceCandidate); // }\n};\n\nvar onIceCandidate = function onIceCandidate(peer, evt) {\n  if (evt.candidate) {\n    channel.trigger(\"client-candidate\", {\n      candidate: evt.candidate,\n      room: room\n    });\n  }\n};\n\nexport var setLocalDescription = function setLocalDescription(sessionDesc) {\n  caller.setLocalDescription(sessionDesc);\n};\nexport var setRemoteDescription = function setRemoteDescription(sessionDesc) {\n  caller.setRemoteDescription(sessionDesc);\n};\nexport var addTrack = function addTrack(track, stream) {\n  console.log(userId, stream);\n  caller.addTrack(track, stream);\n};\nexport var createAnswer = function createAnswer() {\n  caller.createAnswer().then(function (sdp) {\n    var sessionDesc = new RTCSessionDescription(sdp);\n    setLocalDescription(sessionDesc);\n    console.log(room);\n    channel.trigger(\"client-answer\", {\n      sdp: sdp,\n      room: room\n    });\n  });\n  ;\n};\nexport var createOffer = function createOffer() {\n  // return dispatch => {\n  caller.createOffer().then(function (desc) {\n    var sessionDesc = new RTCSessionDescription(desc);\n    setLocalDescription(sessionDesc);\n    channel.trigger(\"client-sdp\", {\n      sdp: desc,\n      room: room,\n      from: userId\n    });\n  }).catch(function (err) {\n    return console.log(err);\n  }); // }\n};","map":{"version":3,"sources":["/Users/gotzil/Downloads/social-media/client/src/store/actions/actionCreators/callActionCreators.js"],"names":["pusher","actionTypes","store","channel","subscribe","caller","window","RTCPeerConnection","userId","localStorage","getItem","room","bind","members","member","console","log","id","alert","msg","addIceCandidate","RTCIceCandidate","candidate","dispatch","type","ON_INCOMING_CALL","answer","confirm","from","trigger","rejected","getMedia","then","stream","getTracks","map","track","addTrack","createAnswer","onLocalStream","sessionDesc","RTCSessionDescription","sdp","setRemoteDescription","ON_LOCAL_STREAM","callUser","user","createOffer","getCam","param","forEach","catch","error","navigator","mediaDevices","getUserMedia","video","audio","prepareCaller","PREPARE_CALLER","onTrack","ON_TRACK","remoteStream","streams","getCallerReady","onicecandidate","evt","onIceCandidate","ontrack","iceCandidate","peer","setLocalDescription","desc","err"],"mappings":"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","sourcesContent":["import pusher from '../../../pusherConfig';\nimport * as actionTypes from '../actions';\nimport { store }  from '../../../index';\n\nconst channel = pusher.subscribe('presence-videocall');\nconst caller = new window.RTCPeerConnection({'iceServers':[{'urls':'stun:stun.l.google.com:19302'}]});\nconst userId = localStorage.getItem('userId');\nlet room;\n//setInterval(()=> console.log(caller), 4000);\nchannel.bind(\"pusher:subscription_succeeded\", members => {\n         \n    //this.setState({id: this.props.channel.members.me.id, room: this.props.callTo});\n    \n  });\n\nchannel.bind(\"pusher:member_added\", member => {\n    console.log(member);\n  });\n\nchannel.bind(\"pusher:member_removed\", member => {\n   \n    if (member.id === room) {\n      //this.endCall();\n      alert('call Ended');\n    }\n    \n  });\nchannel.bind(\"client-candidate\", msg => {\n    console.log('client-candidate')\n    if (msg.room === room) {\n      addIceCandidate(new RTCIceCandidate(msg.candidate));\n    }\n  });\n  channel.bind(\"client-sdp\", msg => {\n      console.log(msg.room, userId)\n    if (msg.room === userId) {\n        store.dispatch({type: actionTypes.ON_INCOMING_CALL});\n        let answer = window.confirm(\n          \"You have a call from \" + msg.from + \": Would you like to answer?\"\n        );\n        if (!answer) {\n          return channel.trigger(\"client-reject\", { room: msg.room, rejected: userId });\n        } else {\n        room = msg.room;\n        //getCam('answer');\n        getMedia().then(stream => {\n        stream.getTracks().map(track => addTrack(track, stream));\n        //let sessionDesc = new RTCSessionDescription(msg.sdp);\n        //setRemoteDescription(sessionDesc);\n        createAnswer(); \n        store.dispatch(onLocalStream(stream));\n        })\n    }\n      }\n    });\n\n    channel.bind(\"client-answer\", answer => {\n        console.log(answer.room, room)\n        if (answer.room === room) {\n            console.log(\"answer received\");\n            console.log(answer);\n            let sessionDesc = new RTCSessionDescription(answer.sdp);\n            setRemoteDescription(sessionDesc);\n          }\n        });\n    \nconst onLocalStream = stream => {\n    return {\n        type: actionTypes.ON_LOCAL_STREAM,\n        stream: stream\n    }\n}\n//Create and send offer to remote peer on button click\nexport const callUser = user => {\n    room = user;\n    return dispatch => {\n        //getCam('not-answer');\n        getMedia().then(stream => {\n            stream.getTracks().map(track => addTrack(track, stream));\n            createOffer();\n            store.dispatch(onLocalStream(stream));\n        })\n    }\n  }    \nconst getCam = (param) => {\n            \n    //Get local audio/video feed and show it in selfview video element\n    // return dispatch => {\n        getMedia().then(stream => {\n\n            stream.getTracks().forEach(track => addTrack(track, stream));\n            \n            if (param !== 'answer'){\n                createOffer();\n            }\n            store.dispatch(onLocalStream(stream));\n        \n        })\n        .catch(error => {\n          console.log(\"an error occured\", error);\n        });;\n    // }\n  }\n\nconst getMedia = () => {\n    return navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      });\n}\nconst prepareCaller = channel => {\n    return {\n        type: actionTypes.PREPARE_CALLER,\n        channel: channel\n    }\n}\nconst onTrack = track => {\n    return {\n        type: actionTypes.ON_TRACK,\n        remoteStream: track.streams[0]\n    }\n}\nexport const getCallerReady = () => {\n    return dispatch => {\n     dispatch(prepareCaller(channel));\n    //Listen for ICE Candidates and send them to remote peers\n    caller.onicecandidate = evt => {\n      if (!evt.candidate) return;\n      onIceCandidate(caller, evt);\n    };\n    //ontrack handler to receive remote feed and show in remoteview video element\n    caller.ontrack = evt => {\n        dispatch(onTrack(evt));\n    };\n    }\n}\nexport const addIceCandidate = iceCandidate => {\n    // return dispatch => {\n        console.log(iceCandidate);\n        caller.addIceCandidate(iceCandidate);\n    // }\n}\n\nconst onIceCandidate = (peer, evt) => {\n    if (evt.candidate) {   \n      channel.trigger(\"client-candidate\", {\n        candidate: evt.candidate,\n        room: room\n      });\n    }\n  }\n\n  export const setLocalDescription = sessionDesc => {\n    caller.setLocalDescription(sessionDesc);\n}\n\nexport const setRemoteDescription = sessionDesc => {\n    caller.setRemoteDescription(sessionDesc);\n}\n\nexport const addTrack = (track, stream) => {\n    console.log(userId, stream);\n    caller.addTrack(track, stream);\n}\n\nexport const createAnswer = () => {\n    caller.createAnswer().then(sdp => {\n        const sessionDesc = new RTCSessionDescription(sdp);\n        setLocalDescription(sessionDesc);\n        console.log(room);\n        channel.trigger(\"client-answer\", {\n            sdp: sdp,\n            room: room\n          });\n        });;\n}\n\nexport const createOffer = () => {\n    // return dispatch => {\n        \n        caller.createOffer().then(desc => {\n            let sessionDesc = new RTCSessionDescription(desc);\n            setLocalDescription(sessionDesc);\n            channel.trigger(\"client-sdp\", {\n              sdp: desc,\n              room: room,\n              from: userId\n            });\n        }).catch(err => console.log(err));\n// }\n}"]},"metadata":{},"sourceType":"module"}